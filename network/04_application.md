# LESSON 7 응용 계층 : 애플리케이션에 데이터 전송하기

## 응용 계층의 역할
- 클라이언트: 서비스를 요청하는 측
  - 웹 브라우저, 메일 프로그램 등 사용자 측에서 사용하는 애플리케이션
- 서버: 서비스를 제공하는 측
  - 웹 서버 프로그램 및 메일 서버 프로그램 > 이러한 애플리케이션은 응용 계층에서 동작
- 응용 계층: 세션 계층과 표현 계층을 포함, 애플리케이션과 데이터를 주고받기 위해 필요
- 사용자 측(클라이언트)의 요청을 전달하기 위해 통신 대상(서버 등)이 이해할 수 있는 메시지(데이터)로 변환하고 전송 계층으로 전달하는 역할

![image](https://user-images.githubusercontent.com/87118337/148054140-1c5688ee-237a-4c21-be3e-8a664e433bfa.png)
- 클라이언트 측 애플리케이션(웹 브라우저, 메일 프로그램 등)이 서버 측 애플리케이션(웹 서버 프로그램, 메일 서버 프로그램 등)과 통신하려면 응용 계층의 프로토콜이 필요
- HTTP(HyperText Transfer Protocol, 하이퍼텍스트 전송 프로토콜): 웹 사이트 접속
- DNS(Domain Name System, 도메인 이름 시스템): 이름 해석
- FTP(File Transfer Protocol, 파일 전송 프로토콜): 파일 전송
- SMTP(Simple Mail Transfer Protocol,전자 우편 전송 프로토콜): 메일 송신
- POP3(Post Office Protocol version, 포스트 오피스 프로토콜): 메일 수신
- 응용 계층은 각각 애플리케이션에 대응되는 데이터를 전송하는 역할

![image](https://user-images.githubusercontent.com/87118337/148054644-66380850-8061-4f47-9613-6579c319192c.png)
- 응용 계층에서 보내려는 데이터는 하위 계층인 전송 계층, 네트워크 계층, 데이터 링크 계층, 물리 계층 순서로 처리 됨

## 웹 서버의 구조 (웹사이트 접속)
### WWW
- W3 or Web
- WWW는 HTML(HyperText Markup Language, 웹페이지에서 문장 구조나 문자를 꾸미는 태그를 사용하여 작성하는 마크업(문장의 일부를 태그로 감싸고 문장을 꾸미기 위한 형식) 언어), URL(Uniform Resouce Locator), HTTP(HyperText Transfer Protocol) 세가지 기술이 사용됨

#### HTML
- 하이퍼텍스트를 작성하는 마크업 언어
- 문자와 이미지를 표시하거나 하이퍼링크를 사용할 수 있음

![image](https://user-images.githubusercontent.com/87118337/148056311-ebe1f01d-f31a-4c58-a107-7d35238fab18.png)
- 문서와 이미지는 각각 별도로 요청
  
#### HTTP
![image](https://user-images.githubusercontent.com/87118337/148058910-0f559709-0488-4971-9e8f-b00e6433c92c.png)
- 클라이언트(웹 브라우저)는 웹 사이트를 보기위해 서버(웹 서버 프로그램)의 80번 포트를 사용하여 HTTP 통신을 함
- 클라이언트에서 HTTP 요청(request)을 보내고 서버에서 HTTP 응답(response)을 반환
- 요청 시에는 'GET'이라고 하는 요청 정보, 파일 이름, 버전 등을 서버에 전송
- 그러면 서버는 응답으로 요청을 정상적으로 처리했다는 'OK'라는 정보를 반환하고 index.html을 클라이언트에 보냄

![image](https://user-images.githubusercontent.com/87118337/148060143-749b87a8-bf38-4f4b-ab63-d1c8de316933.png)
- 예전 HTTP/1.0 버전에서는 요청을 보낼때마다 연결했다가 끊는 작업을 반복했으나
![image](https://user-images.githubusercontent.com/87118337/148061805-f3b42dc8-b93b-4e99-a95e-575492864ac6.png)
- HTTP/1.1 버전부터는 keepalive라는 기능이 추가됨
  - 한번 연결을 수립하면 데이터 교환을 마칠 떄까지 유지하고, 데이터 교환을 모두 끝내면 연결을 끊는 구조, 순서대로 일을 처리하는 특징이 있음
![image](https://user-images.githubusercontent.com/87118337/148062283-88840038-1756-41ff-9ac7-8e70a997fe15.png)
- HTTP/2
  - 1.1에서는 순서대로 응답을 반환해서 이전 요청을 처리하는데 시간이 길어지면 그 다음 요청에 대한 처리가 늦어짐
  - 2버전은 요청 받은 순서대로 응답을 반환하지 않아도 돼서 콘텐츠를 빠르게 표시할 수 있음

## DNS 서버의 구조 (이름 해석)
- 이름 해석을 통해 도메인 이름을 IP 주소로 변환하는 역할
- 컴퓨터(서버)에 접속하려면 IP 주소를 입력해야 하는데 인터넷 창에는 URL을 입력하면 연결이 됨
- 그러니까 간단히 말하면 DNS는 URL을 IP 주소로 변환하는 서비스(시스템)
- 이렇게 url을 통해서 접속하도록 돕는 것을 DNS의 이름 해석(name resolution)이라고 함
- URL에서 컴퓨터나 네트워크를 식별하기 위해 붙여진 이름을 **도메인 이름**이라고 하고, 도메인 이름 앞에 있는 www는 호스트 이름(서버 이름)이라고 함

![image](https://user-images.githubusercontent.com/87118337/148065821-04f60b1a-e7b5-42e4-9629-891a8bb90186.png)
![image](https://user-images.githubusercontent.com/87118337/148067923-f35b94dd-af1c-4367-97b3-ea6a749fe93b.png)
- 처음에는 웹사이트의 IP 주소를 모르니까 먼저 DNS 서버에 요청해서 IP 주소를 확인하고 웹서버에 접속
- 요청한 첫번째 DNS 서버가 도메인의 IP주소를 모르는 경우도 있음
- 그럴 때는 서버 1이 2한테 요청함
- DNS서버는 전세계에 흩어져 있고 모두 계층적으로 연결되어 있음

## 메일 서버의 구조 (SMTP와 POP3)
![image](https://user-images.githubusercontent.com/87118337/148069789-9c9f527d-8ab6-4e1b-9e0b-c7e038abd73a.png)
- 메일을 송수신 하려면 클라이언트 측의 메일 프로그램과 서버 측의 메일 서버 프로그램 간에 통신을 해야함
- 보내는데 사용되는 프로토콜은 SMTP (포트번호 25번)
  - SMTP는 메일 서버 간의 메일 전송에도 이용됨
- 받는데 사용되는 프로토콜은 POP3 (포트번호 110번)
- 컴퓨터 1의 사용자는 메일 서버 1을 사용하는데, 메일 서비스를 제공하는 포털 사이트나 회사의 메일 서버를 사용하는 경우가 많음
- 포털사이트에 가입하거나 회사에서 메일 주소를 받으면 메일 서버를 사용할 수 있게 됨 > 그래서 메일 보낼 때 포텔사이트나 회사 메일서버에 메일을 보내는거 > 그 서버가 여기서 메일 서버 1에 해당
- 메일 서버를 사용하려면 컴퓨터 1에서 사용하는 메일 프로그램에 메일 서비스를 제공하는 메일 서버의 호스트 이름(서버 이름)을 설정하면 됨 > 그러면 메일 서버 1로 메일을 보낼 수 있음

![image](https://user-images.githubusercontent.com/87118337/148073172-c90d585a-96e3-4c40-988d-62a614f9f69f.png)
![image](https://user-images.githubusercontent.com/87118337/148073367-b25182ed-fc48-4fe2-83a5-6144ef8f567e.png)
- 컴퓨터 1에서 메일서버 1로 메일을 보내고
- SMTP를 사용하여 메일 서버 1에서 메일 서버 2로 메일을 전송

![image](https://user-images.githubusercontent.com/87118337/148073852-5777c28a-3b7b-4788-ba6c-2bc8de3a9116.png)
![image](https://user-images.githubusercontent.com/87118337/148074137-104fa8c6-31d5-4d20-b947-389e8148952c.png)
- SMTP로 메일 서버 1이 2로 메일을 전송함
- 메일 서버에는 메일 박스라고 하는 메일을 보관해주는 기능이 있음
- 메일 서버2는 POP3을 사용하여 서버 2의 메일 바긋에서 메일을 가져와서 컴퓨터 2로 전송
- 메일 서버2에 컴퓨터 1의 메일이 도착 > 컴퓨터 2는 메일 서버2의 메일 박스에 있는 메일을 받아가야 함
- 이때 사용자 인증이 필요!
  - 세션 시작
  - 컴퓨터 2에서 받는 사람의 사용자 이름을 통지하고 서버 2에 OK라는 확인 응답 반환
  - 컴퓨터 2에서 수신자의 비밀번호를 통지하고 서버2에 '비밀번호 확인'이라는 확인 응답 반환
  - 컴퓨터 2에서 메일이 있는지 확인후 메일 서버 2는 '있음'이라는 확인 응답을 반환
  - 컴퓨터 2에서 메일 박스에 보관된 이메일을 전송 받음
  - 세션 종료

> ping 명령
> 목적지 컴퓨터와의 통신을 확인하려면 ping 명령을 이용한다. ping 명령은 ICMP(Internet Control Message Protocol)이라는 프로토콜을 사용하여 목적지 컴퓨터에 ICMP 패킷을 전송하고 패킷에 대한 응답이 제대로 오는지 확인하는 명령
> ping 명령이 제대로 실행되면 네트워크 연결이 정상이라고 판단할 수 있으므로 문제를 확인할 때 주로 사용한다
> 사용방법: ping 목적지 IP 주소 or ping 목적지 호스트 이름
